"use strict";(self["webpackChunkfinal_hw"]=self["webpackChunkfinal_hw"]||[]).push([[979],{6453:function(t,s){s.A={inject:["emitter"],created(){this.emitter.emit("get-path",{fullPath:this.$route.fullPath})}}},9155:function(t,s){s.A={data(){return{cart:{},cartLength:"",cartNum:"",productClicked:"",btnLoading:""}},methods:{getCart(){const t="https://vue3-course-api.hexschool.io/api/cms67/cart";this.$http.get(t).then((t=>{this.cart=t.data.data,this.cartLength=this.cart.carts.length,this.emitter.emit("get-cart",{cartLength:this.cartLength})}))},addtoCart(t,s=1){this.productClicked=this.cart.carts.find((s=>s.product_id===t.id)),this.btnLoading=t.id;const e="https://vue3-course-api.hexschool.io/api/cms67/cart",l={product_id:t.id,qty:s};this.$http.post(e,{data:l}).then((t=>{const{title:s}=t.data.data.product;if(this.btnLoading="",this.getCart(),t.data.data.qty>20){const t="已加入到最大數量";this.emitter.emit("push-message",{style:"warning",title:t,content:`購物車內目前已有20件${s}`}),this.updateCart()}else{const t="加入成功";this.emitter.emit("push-message",{style:"success",title:t,content:`已將${s}加入購物車`})}}))},updateCart(){const t=`https://vue3-course-api.hexschool.io/api/cms67/cart/${this.productClicked.id}`,s={product_id:this.productClicked.product_id,qty:20};this.$http.put(t,{data:s}).then((()=>{this.getCart()}))}},created(){this.getCart()}}},5979:function(t,s,e){e.r(s),e.d(s,{default:function(){return H}});var l=e(641),c=e(33);const i={class:"container"},o=(0,l.Fv)('<div class="row align-items-center flex-column mb-5"><div class="col col-md-8 col-xl-7"><div class="row gx-3 text-center"><div class="col-4 border py-3"><h5>step1</h5><p class="m-0">確認訂單</p></div><div class="col-4 border py-3"><h5>step2</h5><p class="m-0">填寫資料</p></div><div class="col-4 border py-3 bg-info"><h5>step3</h5><p class="m-0">付款</p></div></div></div></div>',1),a={class:"row justify-content-center g-5"},r={class:"col-12 col-md-6 col-xl-5"},d=(0,l.Lk)("h4",{class:"mb-3"},"訂單明細",-1),n={class:"col-5 col-xl-3"},u={class:"position-relative w-100 pt-100"},h=["src"],p={class:"col-7 col-xl-9"},k={class:"row flex-column flex-xl-row justify-content-md-between"},L={class:"col-xl-6 fw-bold mb-xl-0"},m={class:"col-xl-2 mb-xl-0"},v={class:"col-xl-4 ps-auto mb-0 text-xl-end"},g={key:0,class:"list-unstyled row bg-white pt-3"},x=(0,l.Lk)("li",{class:"col text-success text-end"},"已使用優惠券",-1),b={class:"col text-success text-end"},f={class:"list-unstyled row bg-white py-3"},y=(0,l.Lk)("li",{class:"col text-end"},"總計",-1),w={class:"col text-end"},C={class:"col-12 col-md-6 col-xl-5"},_=(0,l.Lk)("h4",{class:"mb-3"},"寄貨資料",-1),$={class:"table mb-4"},E=(0,l.Lk)("th",null,"訂單編號",-1),X=(0,l.Lk)("th",null,"Email",-1),O=(0,l.Lk)("th",null,"收件人姓名",-1),j=(0,l.Lk)("th",null,"收件人電話",-1),A=(0,l.Lk)("th",null,"收件人地址",-1),q=(0,l.Lk)("th",null,"付款狀態",-1),F={key:0,class:"text-danger"},N={key:1,class:"text-success"},Q={key:0,class:"row flex-column flex-md-row"},I=(0,l.Lk)("div",{class:"col col-md-7"},[(0,l.Lk)("i",{class:"fa-solid fa-triangle-exclamation me-2"}),(0,l.Lk)("span",{class:"fw-semibold"},"訂單尚未完成!"),(0,l.Lk)("p",null,"確認訂單內容後，點擊付款即完成訂單!")],-1),K={class:"col col-md-5 text-end"},P={class:"row justify-content-center"},T={class:"col-md-12 col-xl-10 text-end"};function W(t,s,e,W,U,z){const B=(0,l.g2)("Loading"),D=(0,l.g2)("router-link");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.bF)(B,{active:U.isLoading},null,8,["active"]),(0,l.Lk)("div",i,[o,(0,l.Lk)("div",a,[(0,l.Lk)("div",r,[d,((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(U.order.products,(s=>((0,l.uX)(),(0,l.CE)("ul",{key:s.id,class:"list-unstyled row border-bottom mb-0 py-3 align-items-center bg-white"},[(0,l.Lk)("li",n,[(0,l.Lk)("div",u,[(0,l.Lk)("img",{src:s.product.imageUrl,alt:"商品圖片",class:"object-fit-cover position-absolute top-0 bottom-0 start-0 end-0 w-100 h-100"},null,8,h)])]),(0,l.Lk)("li",p,[(0,l.Lk)("div",k,[(0,l.Lk)("p",L,(0,c.v_)(s.product.title),1),(0,l.Lk)("p",m,"x"+(0,c.v_)(s.qty),1),(0,l.Lk)("p",v," NT$"+(0,c.v_)(t.$filters.currency(s.final_total)),1)])])])))),128)),U.couponCode?((0,l.uX)(),(0,l.CE)("ul",g,[x,(0,l.Lk)("li",b,(0,c.v_)(U.couponCode),1)])):(0,l.Q3)("",!0),(0,l.Lk)("ul",f,[y,(0,l.Lk)("li",w,"NT$"+(0,c.v_)(t.$filters.currency(U.order.total)),1)])]),(0,l.Lk)("div",C,[_,(0,l.Lk)("table",$,[(0,l.Lk)("tbody",null,[(0,l.Lk)("tr",null,[E,(0,l.Lk)("td",null,(0,c.v_)(U.order.id),1)]),(0,l.Lk)("tr",null,[X,(0,l.Lk)("td",null,(0,c.v_)(U.order.user.email),1)]),(0,l.Lk)("tr",null,[O,(0,l.Lk)("td",null,(0,c.v_)(U.order.user.name),1)]),(0,l.Lk)("tr",null,[j,(0,l.Lk)("td",null,(0,c.v_)(U.order.user.tel),1)]),(0,l.Lk)("tr",null,[A,(0,l.Lk)("td",null,(0,c.v_)(U.order.user.address),1)]),(0,l.Lk)("tr",null,[q,U.order.is_paid?((0,l.uX)(),(0,l.CE)("td",N,"付款完成")):((0,l.uX)(),(0,l.CE)("td",F,"尚未付款"))])])]),U.order.is_paid?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",Q,[I,(0,l.Lk)("div",K,[(0,l.Lk)("button",{class:"btn btn-danger",type:"button",onClick:s[0]||(s[0]=(...t)=>z.payOrder&&z.payOrder(...t))}," 確認付款 ")])]))])]),(0,l.Lk)("div",P,[(0,l.Lk)("div",T,[U.order.is_paid?((0,l.uX)(),(0,l.Wv)(D,{key:0,to:"/",class:"fw-semibold"},{default:(0,l.k6)((()=>[(0,l.eW)(" 回到首頁 ")])),_:1})):(0,l.Q3)("",!0)])])])],64)}var U=e(6453),z=e(9155),B={mixins:[U.A,z.A],data(){return{order:{user:{}},couponCode:"",isLoading:!1}},methods:{getOrder(){this.isLoading=!0;const{orderId:t}=this.$route.params,s=`https://vue3-course-api.hexschool.io/api/cms67/order/${t}`;this.$http.get(s).then((t=>{this.isLoading=!1,this.order=t.data.order;const s=Object.keys(t.data.order.products)[0],e=t.data.order.products[s];e.coupon&&(this.couponCode=e.coupon.code)}))},payOrder(){this.isLoading=!0;const t=`https://vue3-course-api.hexschool.io/api/cms67/pay/${this.order.id}`;this.$http.post(t).then((t=>{if(this.isLoading=!1,t.data.success){this.getOrder();const t="付款成功";this.emitter.emit("push-message",{style:"success",title:t,content:"已完成付款"})}}))}},created(){this.getOrder()}},D=e(6262);const G=(0,D.A)(B,[["render",W]]);var H=G}}]);
//# sourceMappingURL=979.79691e79.js.map