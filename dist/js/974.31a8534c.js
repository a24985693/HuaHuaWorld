"use strict";(self["webpackChunkfinal_hw"]=self["webpackChunkfinal_hw"]||[]).push([[974],{6453:function(t,e){e.A={inject:["emitter"],created(){this.emitter.emit("get-path",{fullPath:this.$route.fullPath})}}},9155:function(t,e){e.A={data(){return{cart:{},cartLength:"",cartNum:"",productClicked:"",btnLoading:""}},methods:{getCart(){const t="https://vue3-course-api.hexschool.io/api/cms67/cart";this.$http.get(t).then((t=>{this.cart=t.data.data,this.cartLength=this.cart.carts.length,this.emitter.emit("get-cart",{cartLength:this.cartLength})}))},addtoCart(t,e=1){this.productClicked=this.cart.carts.find((e=>e.product_id===t.id)),this.btnLoading=t.id;const s="https://vue3-course-api.hexschool.io/api/cms67/cart",l={product_id:t.id,qty:e};this.$http.post(s,{data:l}).then((t=>{const{title:e}=t.data.data.product;if(this.btnLoading="",this.getCart(),t.data.data.qty>20){const t="已加入到最大數量";this.emitter.emit("push-message",{style:"warning",title:t,content:`購物車內目前已有20件${e}`}),this.updateCart()}else{const t="加入成功";this.emitter.emit("push-message",{style:"success",title:t,content:`已將${e}加入購物車`})}}))},updateCart(){const t=`https://vue3-course-api.hexschool.io/api/cms67/cart/${this.productClicked.id}`,e={product_id:this.productClicked.product_id,qty:20};this.$http.put(t,{data:e}).then((()=>{this.getCart()}))}},created(){this.getCart()}}},974:function(t,e,s){s.r(e),s.d(e,{default:function(){return G}});var l=s(641),c=s(33);const a={class:"container"},i=(0,l.Fv)('<div class="row align-items-center flex-column mb-5"><div class="col col-md-8 col-xl-7"><div class="row gx-3 text-center"><div class="col-4 border py-3"><h5>step1</h5><p class="m-0">確認訂單</p></div><div class="col-4 border py-3"><h5>step2</h5><p class="m-0">填寫資料</p></div><div class="col-4 border py-3 bg-info"><h5>step3</h5><p class="m-0">付款</p></div></div></div></div>',1),o={class:"row justify-content-center g-5"},r={class:"col-12 col-xl-5"},d=(0,l.Lk)("h4",{class:"mb-3"},"訂單明細",-1),n={class:"table align-middle"},u=(0,l.Lk)("thead",null,[(0,l.Lk)("tr",null,[(0,l.Lk)("th",{scope:"col"},"品名"),(0,l.Lk)("th",{scope:"col",class:"text-end"},"數量"),(0,l.Lk)("th",{scope:"col",class:"text-end"},"單價")])],-1),h={class:"row flex-column flex-md-row align-items-center"},p={class:"position-relative col w-100 w-xl-50 pt-100 pt-xl-50"},k=["src"],L={class:"col m-0 text-center"},m={class:"text-end"},v={class:"text-end"},g={key:0},x=(0,l.Lk)("td",{colspan:"2",class:"text-end text-success"},"已使用優惠券",-1),f={class:"text-success text-end"},b=(0,l.Lk)("td",{colspan:"2",class:"text-end"},"總計",-1),y={class:"text-end"},C={class:"col-12 col-xl-5"},_=(0,l.Lk)("h4",{class:"mb-3"},"寄貨資料",-1),w={class:"table mb-4"},$=(0,l.Lk)("th",null,"訂單編號",-1),E=(0,l.Lk)("th",null,"Email",-1),X=(0,l.Lk)("th",null,"收件人姓名",-1),O=(0,l.Lk)("th",null,"收件人電話",-1),A=(0,l.Lk)("th",null,"收件人地址",-1),j=(0,l.Lk)("th",null,"付款狀態",-1),q={key:0,class:"text-danger"},F={key:1,class:"text-success"},N={key:0,class:"row flex-column flex-md-row"},Q=(0,l.Lk)("div",{class:"col col-md-7"},[(0,l.Lk)("i",{class:"fa-solid fa-triangle-exclamation me-2"}),(0,l.Lk)("span",{class:"fw-semibold"},"訂單尚未完成!"),(0,l.Lk)("p",null,"確認訂單內容後，點擊付款即完成訂單!")],-1),I={class:"col col-md-5 text-end"},K={class:"row"},P={class:"col text-end"};function T(t,e,s,T,W,U){const z=(0,l.g2)("Loading"),B=(0,l.g2)("router-link");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.bF)(z,{active:W.isLoading},null,8,["active"]),(0,l.Lk)("div",a,[i,(0,l.Lk)("div",o,[(0,l.Lk)("div",r,[d,(0,l.Lk)("table",n,[u,(0,l.Lk)("tbody",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(W.order.products,(e=>((0,l.uX)(),(0,l.CE)("tr",{key:e.id},[(0,l.Lk)("td",h,[(0,l.Lk)("div",p,[(0,l.Lk)("img",{src:e.product.imageUrl,alt:"",class:"object-fit-cover position-absolute top-0 bottom-0 start-0 end-0 w-100 h-100"},null,8,k)]),(0,l.Lk)("p",L,(0,c.v_)(e.product.title),1)]),(0,l.Lk)("td",m,(0,c.v_)(e.qty)+"/"+(0,c.v_)(e.product.unit),1),(0,l.Lk)("td",v,"NT$"+(0,c.v_)(t.$filters.currency(e.final_total)),1)])))),128))]),(0,l.Lk)("tfoot",null,[W.couponCode?((0,l.uX)(),(0,l.CE)("tr",g,[x,(0,l.Lk)("td",f,(0,c.v_)(W.couponCode),1)])):(0,l.Q3)("",!0),(0,l.Lk)("tr",null,[b,(0,l.Lk)("td",y,"NT$"+(0,c.v_)(t.$filters.currency(W.order.total)),1)])])])]),(0,l.Lk)("div",C,[_,(0,l.Lk)("table",w,[(0,l.Lk)("tbody",null,[(0,l.Lk)("tr",null,[$,(0,l.Lk)("td",null,(0,c.v_)(W.order.id),1)]),(0,l.Lk)("tr",null,[E,(0,l.Lk)("td",null,(0,c.v_)(W.order.user.email),1)]),(0,l.Lk)("tr",null,[X,(0,l.Lk)("td",null,(0,c.v_)(W.order.user.name),1)]),(0,l.Lk)("tr",null,[O,(0,l.Lk)("td",null,(0,c.v_)(W.order.user.tel),1)]),(0,l.Lk)("tr",null,[A,(0,l.Lk)("td",null,(0,c.v_)(W.order.user.address),1)]),(0,l.Lk)("tr",null,[j,W.order.is_paid?((0,l.uX)(),(0,l.CE)("td",F,"付款完成")):((0,l.uX)(),(0,l.CE)("td",q,"尚未付款"))])])]),W.order.is_paid?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",N,[Q,(0,l.Lk)("div",I,[(0,l.Lk)("button",{class:"btn btn-danger",onClick:e[0]||(e[0]=(...t)=>U.payOrder&&U.payOrder(...t))}," 確認付款 ")])])),(0,l.Lk)("div",K,[(0,l.Lk)("div",P,[W.order.is_paid?((0,l.uX)(),(0,l.Wv)(B,{key:0,to:"/user/index",class:"fw-semibold"},{default:(0,l.k6)((()=>[(0,l.eW)(" 回到首頁 ")])),_:1})):(0,l.Q3)("",!0)])])])])])],64)}var W=s(6453),U=s(9155),z={mixins:[W.A,U.A],data(){return{order:{user:{}},couponCode:"",isLoading:!1}},methods:{getOrder(){this.isLoading=!0;const{orderId:t}=this.$route.params,e=`https://vue3-course-api.hexschool.io/api/cms67/order/${t}`;this.$http.get(e).then((t=>{this.isLoading=!1,this.order=t.data.order;const e=Object.keys(t.data.order.products)[0],s=t.data.order.products[e];s.coupon&&(this.couponCode=s.coupon.code)}))},payOrder(){this.isLoading=!0;const t=`https://vue3-course-api.hexschool.io/api/cms67/pay/${this.order.id}`;this.$http.post(t).then((t=>{if(this.isLoading=!1,t.data.success){this.getOrder();const t="付款成功";this.emitter.emit("push-message",{style:"success",title:t,content:"已完成付款"})}}))}},created(){this.getOrder()}},B=s(6262);const D=(0,B.A)(z,[["render",T]]);var G=D}}]);
//# sourceMappingURL=974.31a8534c.js.map